\frame{\frametitle{Schematic of \texttt{mcTangent}}
% \bluebox{Architecture}
{
    \def\layersep{2cm}
    \def\nodeinlayersep{.9cm}
    \usetikzlibrary{calc}
    
    \begin{figure}[htb!]
    \centering
    \begin{tikzpicture}[
        node distance=\layersep,
        edge/.style={-stealth,shorten >=1pt, draw=black!50,thin},
        neuron/.style={circle,fill=black!25,minimum size=10pt,inner sep=0pt},
        operator/.style={rectangle,fill=green!,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, inner sep=0pt, rounded corners},
        input neuron/.style={neuron, fill=green!50,minimum size=12pt},
        output neuron/.style={neuron, fill=green!50,minimum size=12pt},
        hidden neuron/.style={neuron, fill=blue!50},
        Forward map/.style={operator, fill=red!50},
        annot/.style={text width=4em, text centered},
        every node/.style={scale=1.0},
        node1/.style={scale=2.0},
        cross/.style={path picture={ \draw[black, shorten <=2pt, shorten >=2pt, line width=1pt] (path picture bounding box.south) -- (path picture bounding box.north); \draw[black, shorten <=2pt, shorten >=2pt, line width=1pt] (path picture bounding box.west) -- (path picture bounding box.east);}}
    ]
    
    \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_in) at (0*\layersep, -2*\nodeinlayersep) {$\ui{{i,0}} + \epsb$};
    \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_ml_1) at (3.0*\layersep, -2*\nodeinlayersep) {$\ut{{i,1}}$};
    \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_ml_2) at (6.0*\layersep, -2*\nodeinlayersep) {$\ut{{i,2}}$};
    % \node[rectangle,fill=yellow!500,minimum height= \nodeinlayersep, minimum width= 0.5 * \layersep, rounded corners] (u_ml_3) at (7.*\layersep, -2*\nodeinlayersep) {$\hdots$};
    
    
    \node[rectangle,fill=blue!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (NN1) at (1.25*\layersep, -2*\nodeinlayersep) {$\Psi$};
    \node[rectangle,fill=blue!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (NN2) at (4.25*\layersep, -2*\nodeinlayersep) {$\Psi$};
    
    \node[rectangle,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (dt) at (1.9*\layersep, -1.8*\nodeinlayersep) {\tiny $ \times \dt$};
    
    \node[rectangle,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (dt) at (4.9*\layersep, -1.8*\nodeinlayersep) {\tiny $ \times \dt$};
    
    \node [draw,circle,cross,minimum width=.02*\layersep,line width=.3pt](cross_1) at (2.3*\layersep, -2*\nodeinlayersep){}; 
    \node [draw,circle,cross,minimum width=.1*\layersep,line width=.3pt](cross_2) at (5.3*\layersep, -2*\nodeinlayersep){};
    % \node [draw,circle,cross,minimum width=.1*\layersep,line width=.3pt](cross_3) at (5.2*\layersep, -4*\nodeinlayersep){};
    
    \node[rectangle,fill=red!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (forward_1) at (1.0*\layersep, -4*\nodeinlayersep) {$\mc{F}$};
    \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_mc_1) at (2.3*\layersep, -4*\nodeinlayersep) {$\ubar{{i,1}}$};
    
    \node[rectangle,fill=red!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (forward) at (4.0*\layersep, -4*\nodeinlayersep) {$\mc{F}$};
    \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_mc) at (5.3*\layersep, -4*\nodeinlayersep) {$\ubar{{i,2}}$};
    
    % \node[rectangle,fill=yellow!50,minimum height= \nodeinlayersep, minimum width= 0.8 * \layersep, rounded corners] (u_mc_2) at (8.0*\layersep, -4*\nodeinlayersep) {$\ubar{{j+2}}$};
    
    \draw[edge,thin] (u_in) -- (NN1);
    \draw[edge,thin] (NN1) -- (cross_1);
    \draw[edge,thin] (cross_1) -- (u_ml_1);
    \draw[edge,thin] (u_ml_1) -- (NN2);
    \draw[edge,thin] (NN2) -- (cross_2);
    \draw[edge,thin] (cross_2) -- (u_ml_2);
    % \draw[edge,thin] (u_ml_2) -- (u_ml_3);
    % \draw[edge,thin] (forward) -- (cross_3);
    % \draw[edge,thin] (cross_3) -- (u_mc);
    
    
    \draw[edge,thin] (.6*\layersep, -2*\nodeinlayersep) -- (.6*\layersep, -1.*\nodeinlayersep) -- (2.3*\layersep, -1.*\nodeinlayersep) -- (cross_1);
    
    \draw[edge,thin] (3.6*\layersep, -2*\nodeinlayersep) -- (3.6*\layersep, -1.*\nodeinlayersep) -- (5.3*\layersep, -1.*\nodeinlayersep) -- (cross_2);
    
    \draw[edge,thin] (u_in) -- (0.0*\layersep, -4.*\nodeinlayersep) -- (forward_1);
    \draw[edge,thin] (forward_1) -- (u_mc_1);
    
    \draw[edge,thin] (u_ml_1) -- (3.0*\layersep, -4.*\nodeinlayersep) -- (forward);
    \draw[edge,thin] (forward) -- (u_mc);
    
    
    
    % LOSS ML TERMS
    \node[rectangle,fill=green!40,minimum height= \nodeinlayersep, minimum width= 3.4 * \layersep, rounded corners] (loss_ml) at (4.5*\layersep, .6*\nodeinlayersep) {Loss $\mc{L}_n$: $ \MSE{\ui{{i,1}} - \ut{{i,1}}} +  \MSE{\ui{{i,2}} - \ut{{i,2}}}$};
    
    \node[rectangle,fill=green!0,minimum height= \nodeinlayersep, minimum width= 3.4 * \layersep, rounded corners] (loss_ml) at (1*\layersep, 1*\nodeinlayersep) {Considering $i$th dataset window};
    
    \node[rectangle,fill=green!0,minimum height= \nodeinlayersep, minimum width= 3.4 * \layersep, rounded corners] (loss_ml) at (1*\layersep, 0.3*\nodeinlayersep) {$\LRp{\ui{{i,0}}, \ui{{i,1}}, \ui{{i,2}}}$};
    
    
    
    \draw[edge,thin] (u_ml_1) -- (3.0*\layersep, .5*\nodeinlayersep - 0.4*\nodeinlayersep);
    \draw[edge,thin] (u_ml_2) -- (6.0*\layersep, .5*\nodeinlayersep - 0.4*\nodeinlayersep);
    
    % LOSS MC TERMS
    \node[rectangle,fill=green!40,minimum height= \nodeinlayersep, minimum width= 1.6 * \layersep, rounded corners] (loss_mc) at (3.0*\layersep, -6.0*\nodeinlayersep) {Loss $\mc{L}_{mc}$: $\alpha \MSE{ \ubar{{i,1}} - \ut{{i,1}}} + \MSE{ \ubar{{i,2}} - \ut{{i,2}}}$};
    % \draw[edge,thin] (u_ml_1) -- (3.0*\layersep, .5*\nodeinlayersep - 0.5*\nodeinlayersep);
    
    \draw[edge,thin] (2.95*\layersep, -2.5*\nodeinlayersep) -- (2.95*\layersep, -5.5*\nodeinlayersep);
    \draw[edge,thin] (u_mc_1) -- (2.95*\layersep, -4.0*\nodeinlayersep) -- (2.95*\layersep, -5.5*\nodeinlayersep);
    
    \draw[edge,thin] (u_ml_2) -- (6.0*\layersep, -6.0*\nodeinlayersep) -- (loss_mc);
    \draw[edge,thin] (u_mc) -- (6.0*\layersep, -4*\nodeinlayersep) -- (6.0*\layersep, -6.0*\nodeinlayersep) -- (loss_mc);
    
        
    \end{tikzpicture}
    \end{figure}
}
}
